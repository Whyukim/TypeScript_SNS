{"version":3,"file":"../pages/index.js","mappings":"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","sources":["webpack://front/./components/PostForm.tsx","webpack://front/./pages/index.tsx","webpack://front/external commonjs \"@ant-design/icons\"","webpack://front/external commonjs \"antd\"","webpack://front/external commonjs \"faker\"","webpack://front/external commonjs \"moment\"","webpack://front/external commonjs \"next-redux-wrapper\"","webpack://front/external commonjs \"next/dist/shared/lib/app-router-context.js\"","webpack://front/external commonjs \"next/dist/shared/lib/head-manager-context.js\"","webpack://front/external commonjs \"next/dist/shared/lib/i18n/normalize-locale-path.js\"","webpack://front/external commonjs \"next/dist/shared/lib/is-plain-object.js\"","webpack://front/external commonjs \"next/dist/shared/lib/mitt.js\"","webpack://front/external commonjs \"next/dist/shared/lib/page-path/denormalize-page-path.js\"","webpack://front/external commonjs \"next/dist/shared/lib/router-context.js\"","webpack://front/external commonjs \"next/dist/shared/lib/router/utils/add-path-prefix.js\"","webpack://front/external commonjs \"next/dist/shared/lib/router/utils/compare-states.js\"","webpack://front/external commonjs \"next/dist/shared/lib/router/utils/format-next-pathname-info.js\"","webpack://front/external commonjs \"next/dist/shared/lib/router/utils/format-url.js\"","webpack://front/external commonjs \"next/dist/shared/lib/router/utils/get-asset-path-from-route.js\"","webpack://front/external commonjs \"next/dist/shared/lib/router/utils/get-next-pathname-info.js\"","webpack://front/external commonjs \"next/dist/shared/lib/router/utils/is-bot.js\"","webpack://front/external commonjs \"next/dist/shared/lib/router/utils/is-dynamic.js\"","webpack://front/external commonjs \"next/dist/shared/lib/router/utils/parse-path.js\"","webpack://front/external commonjs \"next/dist/shared/lib/router/utils/parse-relative-url.js\"","webpack://front/external commonjs \"next/dist/shared/lib/router/utils/path-has-prefix.js\"","webpack://front/external commonjs \"next/dist/shared/lib/router/utils/querystring.js\"","webpack://front/external commonjs \"next/dist/shared/lib/router/utils/remove-trailing-slash.js\"","webpack://front/external commonjs \"next/dist/shared/lib/router/utils/resolve-rewrites.js\"","webpack://front/external commonjs \"next/dist/shared/lib/router/utils/route-matcher.js\"","webpack://front/external commonjs \"next/dist/shared/lib/router/utils/route-regex.js\"","webpack://front/external commonjs \"next/dist/shared/lib/utils.js\"","webpack://front/external commonjs \"next/router\"","webpack://front/external commonjs \"react\"","webpack://front/external commonjs \"react-dom\"","webpack://front/external commonjs \"react-redux\"","webpack://front/external commonjs \"react-slick\"","webpack://front/external commonjs \"react/jsx-runtime\"","webpack://front/external commonjs \"redux\"","webpack://front/external commonjs \"redux-devtools-extension\"","webpack://front/external commonjs \"redux-saga/effects\"","webpack://front/external commonjs \"shortid\"","webpack://front/external commonjs \"styled-components\"","webpack://front/external module \"axios\"","webpack://front/external module \"immer\"","webpack://front/external module \"redux-saga\""],"sourcesContent":["import { Button, Form, Input } from \"antd\";\r\nimport React, { useCallback, useEffect, useRef } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport useInput from \"../hooks/useInput\";\r\nimport { reducerType } from \"../reducers\";\r\nimport {\r\n  addPost,\r\n  ADD_POST_REQUEST,\r\n  REMOVE_IMAGE,\r\n  UPLOAD_IMAGES_REQUEST,\r\n} from \"../reducers/post\";\r\n\r\nconst PostForm = () => {\r\n  const dispatch = useDispatch();\r\n\r\n  const { imagePaths, addPostDone } = useSelector(\r\n    (state: reducerType) => state.post\r\n  );\r\n  const [text, onChagneText, setText] = useInput(\"\");\r\n  const imageInput = useRef<HTMLInputElement>(null);\r\n\r\n  useEffect(() => {\r\n    if (addPostDone) {\r\n      setText(\"\");\r\n    }\r\n  }, [addPostDone]);\r\n\r\n  const onClickImageUpload = useCallback(() => {\r\n    imageInput.current.click();\r\n  }, [imageInput.current]);\r\n\r\n  const onChangeImages = useCallback((e) => {\r\n    const imageFormData = new FormData();\r\n    [].forEach.call(e.target.files, (f) => {\r\n      imageFormData.append(\"image\", f);\r\n    });\r\n    dispatch({\r\n      type: UPLOAD_IMAGES_REQUEST,\r\n      data: imageFormData,\r\n    });\r\n  }, []);\r\n\r\n  const onRemoveImage = useCallback(\r\n    (index) => () => {\r\n      dispatch({\r\n        type: REMOVE_IMAGE,\r\n        data: index,\r\n      });\r\n    },\r\n    []\r\n  );\r\n\r\n  const onSubmit = useCallback(() => {\r\n    if (!text || !text.trim()) return alert(\"게시글을 작성하세요.\");\r\n\r\n    const formData = new FormData();\r\n    imagePaths.forEach((i) => {\r\n      formData.append(\"image\", i);\r\n    });\r\n    formData.append(\"content\", text);\r\n    dispatch({ type: ADD_POST_REQUEST, data: formData });\r\n  }, [text, imagePaths]);\r\n\r\n  return (\r\n    <Form\r\n      style={{ margin: \"10px 0 20px\" }}\r\n      encType=\"multipart/form-data\"\r\n      onFinish={onSubmit}\r\n    >\r\n      <Input.TextArea\r\n        value={text}\r\n        onChange={onChagneText}\r\n        maxLength={140}\r\n        placeholder=\"텍스트를 입력해주시길 바랍니다.\"\r\n      />\r\n      <div>\r\n        <input\r\n          type=\"file\"\r\n          name=\"image\"\r\n          multiple\r\n          hidden\r\n          ref={imageInput}\r\n          onChange={onChangeImages}\r\n        />\r\n        <Button onClick={onClickImageUpload}>이미지 업로드</Button>\r\n        <Button type=\"primary\" style={{ float: \"right\" }} htmlType=\"submit\">\r\n          보내기\r\n        </Button>\r\n      </div>\r\n      <div>\r\n        {imagePaths.map((v, i) => (\r\n          <div key={v} style={{ display: \"inline-block\" }}>\r\n            <img\r\n              src={`http://localhost:3065/${v}`}\r\n              style={{ width: \"200px\" }}\r\n              alt={v}\r\n            />\r\n            <div>\r\n              <Button onClick={onRemoveImage(i)}>제거</Button>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </Form>\r\n  );\r\n};\r\n\r\nexport default PostForm;\r\n","import axios from \"axios\";\r\nimport { FC, useEffect } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { END } from \"redux-saga\";\r\nimport AppLayout from \"../components/AppLayout\";\r\nimport PostCard from \"../components/PostCard\";\r\nimport PostForm from \"../components/PostForm\";\r\nimport { reducerType } from \"../reducers\";\r\nimport { LOAD_POSTS_REQUEST } from \"../reducers/post\";\r\nimport { LOAD_MY_INFO_REQUEST } from \"../reducers/user\";\r\nimport wrapper from \"../store/configureStore\";\r\n\r\nconst Home: FC = () => {\r\n  const dispatch = useDispatch();\r\n\r\n  const { me } = useSelector((state: reducerType) => state.user);\r\n  const { mainPosts, hasMorePosts, loadPostsLoading, retweetError } =\r\n    useSelector((state: reducerType) => state.post);\r\n\r\n  useEffect(() => {\r\n    if (retweetError) alert(retweetError);\r\n  }, [retweetError]);\r\n\r\n  useEffect(() => {\r\n    function onScroll() {\r\n      if (\r\n        window.pageYOffset + document.documentElement.clientHeight >\r\n        document.documentElement.scrollHeight - 300\r\n      ) {\r\n        if (hasMorePosts && !loadPostsLoading) {\r\n          const lastId = mainPosts[mainPosts.length - 1]?.id;\r\n          dispatch({\r\n            type: LOAD_POSTS_REQUEST,\r\n            lastId,\r\n          });\r\n        }\r\n      }\r\n    }\r\n    window.addEventListener(\"scroll\", onScroll);\r\n    return () => {\r\n      window.removeEventListener(\"scroll\", onScroll);\r\n    };\r\n  }, [hasMorePosts, loadPostsLoading, mainPosts]);\r\n\r\n  return (\r\n    <AppLayout>\r\n      {me && <PostForm />}\r\n      {mainPosts.map((post, index) => (\r\n        <PostCard key={post.id} post={post} />\r\n      ))}\r\n    </AppLayout>\r\n  );\r\n};\r\n\r\nexport const getServerSideProps = wrapper.getServerSideProps(\r\n  async (context) => {\r\n    const cookie = context.req ? context.req.headers.cookie : \"\";\r\n    axios.defaults.headers.Cookie = \"\";\r\n\r\n    // 프론트 서버에서 쿠기가 공유되는 문제\r\n    if (context.req && cookie) {\r\n      axios.defaults.headers.Cookie = cookie;\r\n    }\r\n\r\n    context.store.dispatch({\r\n      type: LOAD_MY_INFO_REQUEST,\r\n    });\r\n\r\n    context.store.dispatch({ type: LOAD_POSTS_REQUEST });\r\n\r\n    context.store.dispatch(END);\r\n    await context.store.sagaTask.toPromise();\r\n  }\r\n);\r\n\r\nexport default Home;\r\n","module.exports = require(\"@ant-design/icons\");","module.exports = require(\"antd\");","module.exports = require(\"faker\");","module.exports = require(\"moment\");","module.exports = require(\"next-redux-wrapper\");","module.exports = require(\"next/dist/shared/lib/app-router-context.js\");","module.exports = require(\"next/dist/shared/lib/head-manager-context.js\");","module.exports = require(\"next/dist/shared/lib/i18n/normalize-locale-path.js\");","module.exports = require(\"next/dist/shared/lib/is-plain-object.js\");","module.exports = require(\"next/dist/shared/lib/mitt.js\");","module.exports = require(\"next/dist/shared/lib/page-path/denormalize-page-path.js\");","module.exports = require(\"next/dist/shared/lib/router-context.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/add-path-prefix.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/compare-states.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/format-next-pathname-info.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/format-url.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/get-asset-path-from-route.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/get-next-pathname-info.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/is-bot.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/is-dynamic.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/parse-path.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/parse-relative-url.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/path-has-prefix.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/querystring.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/remove-trailing-slash.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/resolve-rewrites.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/route-matcher.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/route-regex.js\");","module.exports = require(\"next/dist/shared/lib/utils.js\");","module.exports = require(\"next/router\");","module.exports = require(\"react\");","module.exports = require(\"react-dom\");","module.exports = require(\"react-redux\");","module.exports = require(\"react-slick\");","module.exports = require(\"react/jsx-runtime\");","module.exports = require(\"redux\");","module.exports = require(\"redux-devtools-extension\");","module.exports = require(\"redux-saga/effects\");","module.exports = require(\"shortid\");","module.exports = require(\"styled-components\");","module.exports = import(\"axios\");;","module.exports = import(\"immer\");;","module.exports = import(\"redux-saga\");;"],"names":["Button","Form","Input","React","useCallback","useEffect","useRef","useDispatch","useSelector","useInput","ADD_POST_REQUEST","REMOVE_IMAGE","UPLOAD_IMAGES_REQUEST","PostForm","dispatch","imagePaths","addPostDone","state","post","text","onChagneText","setText","imageInput","onClickImageUpload","current","click","onChangeImages","e","imageFormData","FormData","forEach","call","target","files","f","append","type","data","onRemoveImage","index","onSubmit","trim","alert","formData","i","margin","float","map","v","display","width","axios","END","AppLayout","PostCard","LOAD_POSTS_REQUEST","LOAD_MY_INFO_REQUEST","wrapper","Home","me","user","mainPosts","hasMorePosts","loadPostsLoading","retweetError","onScroll","window","pageYOffset","document","documentElement","clientHeight","scrollHeight","lastId","length","id","addEventListener","removeEventListener","getServerSideProps","context","cookie","req","headers","defaults","Cookie","store","sagaTask","toPromise"],"sourceRoot":""}